<!DOCTYPE html>
<html>
<head>
  <title>MyAdExchange Adapter Test</title>
  <script async src="../../../build/dev/prebid.js"></script>
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
  <style>
    #ad-container {
      display: flex;
      gap: 20px;
      margin-top: 20px;
    }
    .ad-slot {
      border: 1px solid #ccc;
      padding: 10px;
      width: 300px;
      height: 250px;
    }
  </style>
</head>
<body>
  <h1>MyAdExchange Adapter Test Page</h1>
  <button onclick="requestAds()">Request Ads</button>

  <div id="ad-container">
    <div id="div-gpt-ad-1" class="ad-slot"></div>
    <div id="div-gpt-ad-2" class="ad-slot"></div>
  </div>

  <script>
    var adUnits = [
      {
        code: 'div-gpt-ad-1',
        mediaTypes: {
          banner: {
            sizes: [[300, 250]]
          }
        },
        bids: [{
          bidder: 'myadexchange',
          params: {
            placementId: '123'
          }
        }]
      },
      {
        code: 'div-gpt-ad-2',
        mediaTypes: {
          video: {
            context: 'instream',
            playerSize: [640, 480]
          }
        },
        bids: [{
          bidder: 'myadexchange',
          params: {
            placementId: '456'
          }
        }]
      }
    ];

    window.pbjs = window.pbjs || {};
    pbjs.que = pbjs.que || [];

    window.googletag = window.googletag || {cmd: []};

    googletag.cmd.push(function() {
      googletag.defineSlot('/19968336/header-bid-tag', [300, 250], 'div-gpt-ad-1').addService(googletag.pubads());
      googletag.defineSlot('/19968336/header-bid-tag-video', [640, 480], 'div-gpt-ad-2').addService(googletag.pubads());
      googletag.pubads().disableInitialLoad();
      googletag.enableServices();
    });

    function requestAds() {
      pbjs.que.push(function() {
        pbjs.addAdUnits(adUnits);
        pbjs.requestBids({
          bidsBackHandler: function() {
            pbjs.setTargetingForGPTAsync();
            googletag.pubads().refresh();
          }
        });
      });
    }
  </script>
</body>
</html>
